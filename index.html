<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@ain1084/audio-worklet-stream - v1.0.1</title><meta name="description" content="Documentation for @ain1084/audio-worklet-stream"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@ain1084/audio-worklet-stream - v1.0.1</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@ain1084/audio-worklet-stream - v1.0.1</h1></div><div class="tsd-panel tsd-typography"><a id="md:audio-worklet-stream-library" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Audio Worklet Stream Library<a href="#md:audio-worklet-stream-library" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://badge.fury.io/js/@ain1084%2Faudio-worklet-stream" target="_blank" class="external"><img src="https://badge.fury.io/js/@ain1084%2Faudio-worklet-stream.svg" alt="npm version"></a>
<a href="https://github.com/ain1084/audio-worklet-stream/actions?query=workflow%3Adocs" target="_blank" class="external"><img src="https://github.com/ain1084/audio-worklet-stream/workflows/docs/badge.svg" alt="Documentation"></a>
<a href="https://opensource.org/licenses/MIT" target="_blank" class="external"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
<a href="https://opensource.org/licenses/Apache-2.0" target="_blank" class="external"><img src="https://img.shields.io/badge/License-Apache_2.0-blue.svg" alt="License"></a></p>
<p>This library provides a way to work with audio worklets and streams using modern web technologies. It allows for the manual writing of audio frames to a buffer and supports various buffer writing strategies.</p>
<p>This library was created for use in my project <a href="https://github.com/ain1084/fbdplay_wasm" target="_blank" class="external">fbdplay_wasm</a>. In this project, we utilize only a very limited set of WebAudio functionalities. It might lack features for general use.</p>
<a id="md:features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Features<a href="#md:features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Manual Buffer Writing</strong>: Provides the ability to manually write audio frames to a buffer.</li>
<li><strong>Multiple Buffer Writing Strategies</strong>: Includes support for manual, timer-based, and worker-based buffer writing.</li>
<li><strong>Worker-Based Stability</strong>: Utilizes Workers to ensure stable and consistent audio playback, reducing the impact of UI thread throttling.</li>
<li><strong>Vite Integration</strong>: Leverages Vite for easy worker loading and configuration without complex setup.</li>
<li><strong>Audio Worklet Integration</strong>: Seamlessly integrates with the Web Audio API's Audio Worklet for real-time audio processing.</li>
<li><strong>Optimized Performance</strong>: Designed for efficient real-time audio processing with batch frame handling.</li>
</ul>
<a id="md:browser-compatibility" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Browser Compatibility<a href="#md:browser-compatibility" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to expand browser compatibility details</summary>
<p>This library uses modern Web APIs and is designed for contemporary browsers only. Tested and confirmed working on:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Feature</th>
<th style="text-align:center">Chrome</th>
<th style="text-align:center">Chrome (Android)</th>
<th style="text-align:center">Firefox</th>
<th style="text-align:center">Safari (macOS)</th>
<th style="text-align:center">Safari (iOS)</th>
<th style="text-align:center">Edge</th>
<th style="text-align:center">Opera</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Basic Support</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
</tr>
<tr>
<td style="text-align:left">Manual Buffer Writing</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
</tr>
<tr>
<td style="text-align:left">Timer-Based Buffer Writing</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">üî∫</td>
<td style="text-align:center">‚ùì</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
</tr>
<tr>
<td style="text-align:left">Worker-Based Stability</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
<td style="text-align:center">‚úÖ</td>
<td style="text-align:center">‚ùì</td>
</tr>
</tbody>
</table>
<p>Legend:</p>
<ul>
<li>‚úÖ: Confirmed and working without issues</li>
<li>üî∫: Confirmed with limitations (e.g., unstable in background operation)</li>
<li>‚ùì: Not yet confirmed</li>
</ul>
<p>Note: Compatibility with Safari on iOS has not been confirmed due to lack of test devices.</p>
<p>To check compatibility in your environment, please run the demo in the example directory.</p>
</details>
<a id="md:prerequisites" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Prerequisites<a href="#md:prerequisites" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Node.js</strong> and <strong>npm</strong>: Make sure you have Node.js (version 20 or higher) and npm installed. This library hasn't been tested on versions below 20.</li>
<li><strong>Vite</strong>: This library uses Vite as the bundler for its simplicity in loading and configuring workers.</li>
</ul>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>To install the library, run:</p>
<pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@ain1084/audio-worklet-stream</span>
</code><button type="button">Copy</button></pre>

<details>
<summary>Click to view configuration details</summary>
<p>You need to add <code>@ain1084/audio-worklet-stream</code> to the optimizeDeps.exclude section in <code>vite.config.ts</code>. Furthermore, include the necessary <strong>COOP (Cross-Origin Opener Policy)</strong> and <strong>COEP (Cross-Origin Embedder Policy)</strong> settings to enable the use of <code>SharedArrayBuffer</code>.</p>
<a id="md:viteconfigts" class="tsd-anchor"></a><h3 class="tsd-anchor-link">vite.config.ts<a href="#md:viteconfigts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">defineConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;vite&#39;</span><br/><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-0">defineConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizeDeps:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">exclude:</span><span class="hl-1"> [</span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">plugins:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;configure-response-headers&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">configureServer</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">server</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">server</span><span class="hl-1">.</span><span class="hl-4">middlewares</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">((</span><span class="hl-4">_req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">, </span><span class="hl-4">next</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Embedder-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;require-corp&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;same-origin&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">          </span><span class="hl-0">next</span><span class="hl-1">()</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

<p>If you are using Nuxt3, add it under vite in <code>nuxt.config.ts</code>.</p>
<a id="md:nuxtconfigts" class="tsd-anchor"></a><h3 class="tsd-anchor-link">nuxt.config.ts<a href="#md:nuxtconfigts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-0">defineNuxtConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">vite:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">optimizeDeps:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">exclude:</span><span class="hl-1"> [</span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">plugins:</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;configure-response-headers&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">configureServer</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">server</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">server</span><span class="hl-1">.</span><span class="hl-4">middlewares</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">((</span><span class="hl-4">_req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">, </span><span class="hl-4">next</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Embedder-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;require-corp&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;same-origin&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-0">next</span><span class="hl-1">()</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">nitro:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">rollupConfig:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">external:</span><span class="hl-1"> </span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">routeRules:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/**&#39;</span><span class="hl-4">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">headers:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">&#39;Cross-Origin-Embedder-Policy&#39;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-2">&#39;require-corp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-2">&#39;same-origin&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

</details>
<a id="md:usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#md:usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to expand usage details</summary>
<a id="md:overview" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Overview<a href="#md:overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This library continuously plays audio sample frames using AudioWorkletNode. The audio sample frames need to be supplied externally via a ring buffer. The library provides functionality to retrieve the number of written and read (played) frames and allows stopping playback at a specified frame.</p>
<p>The output-only AudioNode is implemented by the OutputStreamNode class, which inherits from AudioWorkletNode. This class adds functionalities such as stream playback, stopping, and retrieving playback position to the AudioWorkletNode.</p>
<p>Instances of OutputStreamNode cannot be constructed directly. First, an instance of StreamNodeFactory needs to be created. The StreamNodeFactory is instantiated by calling its static create method with a BaseAudioContext as an argument. This method internally loads the necessary modules. Then, through the returned instance, the construction of OutputStreamNode becomes possible.</p>
<p>The library does not handle the construction or destruction of AudioContext. When constructing AudioContext, be sure to do so in response to a user interaction, such as a UI event (e.g., button press).</p>
<p>Example:</p>
<pre><code class="typescript"><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">audioContext</span><span class="hl-1">: </span><span class="hl-6">AudioContext</span><span class="hl-1"> | </span><span class="hl-6">null</span><span class="hl-1"> = </span><span class="hl-5">null</span><br/><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">factory</span><span class="hl-1">: </span><span class="hl-6">StreamNodeFactory</span><span class="hl-1"> | </span><span class="hl-6">null</span><span class="hl-1"> = </span><span class="hl-5">null</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">clicked</span><span class="hl-1"> = </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-4">audioContext</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">audioContext</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">AudioContext</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-4">factory</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">StreamNodeFactory</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-4">audioContext</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">node</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">factory</span><span class="hl-1">.</span><span class="hl-0">createManualBufferNode</span><span class="hl-1">( { </span><span class="hl-4">channelCount:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">, </span><span class="hl-4">frameBufferSize:</span><span class="hl-1"> </span><span class="hl-8">4096</span><span class="hl-1"> })</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:buffer-writing-methods" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Buffer Writing Methods<a href="#md:buffer-writing-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>As outlined in the overview, OutputStreamNode requires external audio samples. These samples must be written to a ring buffer, and there are several methods to achieve this.</p>
<a id="md:manual" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Manual<a href="#md:manual" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li>This method involves manually writing to the ring buffer. Use the <code>OutputStreamFactory.createManualBufferNode</code> method, specifying the number of channels and frames.</li>
<li>When the OutputStreamNode is first constructed, the ring buffer is empty. Typically, you need to write to the ring buffer before starting playback. While the node is playing, you must continue writing to the ring buffer to prevent audio frame depletion.</li>
<li>If the audio frames run out, the stream playback continues with the node outputting silence.</li>
<li>To stop the stream playback, call the <code>stop()</code> method of OutputStreamNode. You can specify the frame at which to stop playback. If you want to play all the written frames, you can specify the total number of written frames, which can be obtained via the FrameBufferWriter.</li>
</ul>
<a id="md:timed" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Timed<a href="#md:timed" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li>This method writes to the ring buffer using a timer initiated on the UI thread. Create it using the <code>OutputStreamFactory.createTimedBufferNode()</code> method, specifying the number of channels, timer interval, and the FrameBufferFiller that supplies samples to the buffer.</li>
<li>Writing to the ring buffer is handled by the FrameBufferFiller. The timer periodically calls the <code>fill</code> method of the FrameBufferFiller, which supplies audio frames via the FrameBufferWriter.</li>
<li>If the audio frames run out, the stream playback continues with the node outputting silence.</li>
<li>If the <code>fill</code> method of the FrameBufferFiller returns false, it indicates the end of the audio frame supply. Once OutputStreamNode outputs all the written frames, the stream automatically stops and disconnects.</li>
<li>Like the Manual method, you can also stop playback at any time using the <code>stop()</code> method.</li>
</ul>
<a id="md:worker" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Worker<a href="#md:worker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li>Similar to the Timed method, this method uses a timer to write to the ring buffer, but the timer runs within a Worker. This approach reduces the impact of UI thread throttling, providing more stable playback.</li>
<li>Create it using the <code>OutputStreamFactory.createWorkerBufferNode()</code> method.</li>
<li>Writing to the ring buffer occurs within the Worker.</li>
<li>While the ring buffer writing is still managed by the FrameBufferFiller, the instance must be created and used within the Worker.</li>
<li>The instantiation of the FrameBufferFiller implementation class is done within the Worker.</li>
<li>You need to create a custom Worker, but helper implementations are available, simplifying this process. Essentially, you only need to specify the FrameBufferFiller implementation class within the Worker.</li>
<li>Depending on how you implement the FrameBufferFiller class, you can use the same implementation as the Timed method.</li>
</ul>
</details>
<a id="md:buffer-underrun-handling" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Buffer Underrun Handling<a href="#md:buffer-underrun-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>When the buffer becomes empty, silent audio is output instead of throwing an error.</li>
<li>The AudioNode continues to operate and consume CPU resources even during silent output.</li>
<li>Normal audio output resumes automatically when new audio data is supplied.</li>
<li>An UnderrunEvent is emitted upon recovery from an underrun, reporting the duration of silence (note: this is a post-event notification).</li>
</ul>
<a id="md:details-of-configuration-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Details of Configuration Parameters<a href="#md:details-of-configuration-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to view details about configuration parameters</summary>
<p>Understanding these parameters is crucial for optimal audio performance:</p>
<a id="md:channelcount-all-strategies" class="tsd-anchor"></a><h3 class="tsd-anchor-link">channelCount (All strategies)<a href="#md:channelcount-all-strategies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Specifies the number of audio channels (e.g., 2 for stereo).</li>
<li>Determines the sample composition within each frame.</li>
</ul>
<a id="md:framebuffersize-manual-strategy-only" class="tsd-anchor"></a><h3 class="tsd-anchor-link">frameBufferSize (Manual strategy only)<a href="#md:framebuffersize-manual-strategy-only" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Defines the size of the ring buffer in frames.</li>
<li>For continuous streaming, new frames must be supplied before buffer depletion.</li>
<li>Larger size: Less susceptible to interruptions, but increases latency.</li>
<li>Smaller size: Requires more frequent writes, potentially increasing CPU load.</li>
<li>Manual strategy: Must be specified.</li>
<li>Timed/Worker strategies: Calculated internally based on fillInterval.</li>
</ul>
<a id="md:fillinterval-timed-and-worker-strategies-only" class="tsd-anchor"></a><h3 class="tsd-anchor-link">fillInterval (Timed and Worker strategies only)<a href="#md:fillinterval-timed-and-worker-strategies-only" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Specifies the interval for buffer refill timer.</li>
<li>Default: 20ms.</li>
</ul>
<a id="md:framebufferchunks-timed-and-worker-strategies-only" class="tsd-anchor"></a><h3 class="tsd-anchor-link">frameBufferChunks (Timed and Worker strategies only)<a href="#md:framebufferchunks-timed-and-worker-strategies-only" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Specifies the number of chunks in the total buffer size.</li>
<li>Default: 5.</li>
</ul>
<p>Example calculation:
For 48kHz sample rate and 20ms fillInterval:</p>
<ul>
<li>One chunk size = 48000 * 0.02 = 960 frames</li>
<li>Total buffer size with default 5 chunks = 960 * 5 = 4800 frames</li>
</ul>
<p>The actual values may slightly differ from the above because they are rounded up to 128 sample units.</p>
</details>
<a id="md:example" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Example<a href="#md:example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to view example details</summary>
<p>The example can be found at <a href="https://github.com/ain1084/audio-worklet-stream/tree/main/example" target="_blank" class="external">example</a>.</p>
<p>The provided example demonstrates how to use the library to manually write audio frames to a buffer. It includes:</p>
<ul>
<li><strong>Main Application</strong> (<a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/src/main.ts" target="_blank" class="external">example/src/main.ts</a>): Sets up and starts the audio stream using different buffer writing strategies.</li>
<li><strong>Sine Wave Filler</strong> (<a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/src/sine-wave-frame-buffer-filler.ts" target="_blank" class="external">example/src/sine-wave-frame-buffer-filler.ts</a>): Implements a frame buffer filler that generates a sine wave.</li>
<li><strong>Sine Wave Generator</strong> (<a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/src/sine-wave-generator.ts" target="_blank" class="external">example/src/sine-wave-generator.ts</a>): Generates sine wave values for the buffer filler.</li>
<li><strong>Worker</strong> (<a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/src/worker.ts" target="_blank" class="external">example/src/worker.ts</a>): Sets up a worker to handle buffer filling tasks.</li>
<li><strong>HTML Entry Point</strong> (<a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/index.html" target="_blank" class="external">example/index.html</a>): Provides the HTML structure and buttons to control the audio stream.</li>
</ul>
<p>For more details, refer to the <a href="https://github.com/ain1084/audio-worklet-stream/blob/main/example/README.md" target="_blank" class="external">example/README.md</a>.</p>
</details>
<a id="md:performance-optimization-guide" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Performance Optimization Guide<a href="#md:performance-optimization-guide" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to expand performance optimization details</summary>
<p>This guide provides tips and best practices for optimizing the performance of your audio application using the Audio Worklet Stream Library.</p>
<a id="md:batch-processing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Batch Processing<a href="#md:batch-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Our library is optimized for processing audio frames in large batches. To maximize performance:</p>
<ol>
<li>When implementing your own audio generation or processing logic, work with larger chunks of audio data whenever possible.</li>
<li>Utilize the library's ability to handle multiple frames at once in your buffer filling strategies.</li>
</ol>
<a id="md:buffer-size-considerations" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Buffer Size Considerations<a href="#md:buffer-size-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Larger buffer sizes can improve performance but may increase latency.</li>
<li>Experiment with different buffer sizes to find the optimal balance between performance and latency for your specific use case.</li>
</ul>
<a id="md:worker-based-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Worker-Based Strategy<a href="#md:worker-based-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For the most stable playback, especially in scenarios where the main thread might be busy:</p>
<ol>
<li>Use the Worker-based buffer writing strategy.</li>
<li>Implement computationally intensive tasks within the Worker to avoid impacting the main thread.</li>
</ol>
<a id="md:memory-management" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memory Management<a href="#md:memory-management" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>When working with multiple audio streams, be mindful of memory usage.</li>
<li>For scenarios requiring numerous concurrent audio streams, pay attention to the creation and resource management of each stream. Consider properly releasing unused streams when necessary.</li>
</ul>
<a id="md:avoid-frequent-audiocontext-creation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Avoid Frequent AudioContext Creation<a href="#md:avoid-frequent-audiocontext-creation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Creating new AudioContext instances is expensive. Reuse existing contexts when possible.</li>
<li>If your application requires multiple audio streams, try to use a single AudioContext for all of them.</li>
</ul>
<a id="md:profiling-and-monitoring" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Profiling and Monitoring<a href="#md:profiling-and-monitoring" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Use browser developer tools to profile your application and identify performance bottlenecks.</li>
<li>Monitor CPU usage and audio underruns to ensure smooth playback.</li>
</ul>
<p>By following these guidelines, you can ensure that your audio application runs efficiently and provides a smooth user experience.</p>
</details>
<a id="md:advanced-usage-guide" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Advanced Usage Guide<a href="#md:advanced-usage-guide" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to expand advanced usage details</summary>
<p>This guide covers advanced usage scenarios and techniques for the Audio Worklet Stream Library.</p>
<a id="md:advanced-worker-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Advanced Worker Usage<a href="#md:advanced-worker-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For complex audio processing tasks:</p>
<ol>
<li>Create a custom Worker that extends <code>BufferFillWorker</code>.</li>
<li>Implement advanced audio processing algorithms within the Worker.</li>
<li>Use <code>SharedArrayBuffer</code> for efficient data sharing between the main thread and the Worker.</li>
</ol>
<a id="md:handling-multiple-audio-streams" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Handling Multiple Audio Streams<a href="#md:handling-multiple-audio-streams" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When working with multiple audio streams:</p>
<ol>
<li>Create separate <code>OutputStreamNode</code> instances for each stream.</li>
<li>Manage their lifecycle and synchronization carefully.</li>
<li>Consider implementing a mixer if you need to combine multiple streams.</li>
</ol>
<a id="md:integrating-with-other-web-audio-api-features" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Integrating with Other Web Audio API Features<a href="#md:integrating-with-other-web-audio-api-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>You can combine this library with other Web Audio API features:</p>
<ol>
<li>Connect the <code>OutputStreamNode</code> to other AudioNodes for additional processing.</li>
<li>Use AnalyserNode for visualizations.</li>
<li>Implement spatial audio using PannerNode.</li>
</ol>
<a id="md:error-handling-and-debugging" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Error Handling and Debugging<a href="#md:error-handling-and-debugging" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For robust applications:</p>
<ol>
<li>Implement comprehensive error handling, especially for Worker-based strategies.</li>
<li>Use the UnderrunEvent to detect and handle buffer underruns.</li>
<li>Implement logging or metrics collection for performance monitoring.</li>
</ol>
<p>These advanced techniques will help you leverage the full power of the Audio Worklet Stream Library in complex audio applications.</p>
</details>
<a id="md:troubleshooting-guide" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Troubleshooting Guide<a href="#md:troubleshooting-guide" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to expand troubleshooting details</summary>
<p>This guide helps you troubleshoot common issues when using the Audio Worklet Stream Library.</p>
<a id="md:audio-playback-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Audio Playback Issues<a href="#md:audio-playback-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="md:no-sound" class="tsd-anchor"></a><h4 class="tsd-anchor-link">No Sound<a href="#md:no-sound" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Check if your AudioContext is in the 'running' state. It may need to be resumed after user interaction.</li>
<li>Ensure your OutputStreamNode is properly connected to the AudioContext destination.</li>
<li>Verify that you're writing audio data to the buffer correctly.</li>
</ol>
<a id="md:choppy-or-glitchy-playback" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Choppy or Glitchy Playback<a href="#md:choppy-or-glitchy-playback" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Increase your buffer size to reduce the chance of underruns.</li>
<li>If using the Timed strategy, consider switching to the Worker strategy for more stable playback.</li>
<li>Check your system's CPU usage. High CPU usage can cause audio glitches.</li>
</ol>
<a id="md:buffer-underruns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Buffer Underruns<a href="#md:buffer-underruns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If you're experiencing frequent UnderrunEvents:</p>
<ol>
<li>Increase your buffer size.</li>
<li>Optimize your audio data generation/loading process.</li>
<li>If using the Manual strategy, ensure you're writing to the buffer frequently enough.</li>
</ol>
<a id="md:worker-related-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Worker-Related Issues<a href="#md:worker-related-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="md:worker-not-starting" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Worker Not Starting<a href="#md:worker-not-starting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Ensure your Worker file is in the correct location and properly bundled.</li>
<li>Check for any console errors related to Worker initialization.</li>
</ol>
<a id="md:data-not-being-processed-in-worker" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Data Not Being Processed in Worker<a href="#md:data-not-being-processed-in-worker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Verify that your FrameBufferFiller implementation in the Worker is correct.</li>
<li>Check the message passing between the main thread and the Worker.</li>
</ol>
<a id="md:browser-compatibility-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Browser Compatibility Issues<a href="#md:browser-compatibility-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="md:feature-not-working-in-specific-browsers" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Feature Not Working in Specific Browsers<a href="#md:feature-not-working-in-specific-browsers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Refer to the Browser Compatibility table in the README.</li>
<li>Ensure you're using the latest version of the browser.</li>
<li>Check if the required features (like SharedArrayBuffer) are enabled in the browser.</li>
</ol>
<a id="md:build-and-integration-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Build and Integration Issues<a href="#md:build-and-integration-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="md:module-not-found-errors" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Module Not Found Errors<a href="#md:module-not-found-errors" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Ensure <code>@ain1084/audio-worklet-stream</code> is properly installed.</li>
<li>Check your bundler configuration, especially the <code>optimizeDeps.exclude</code> setting in Vite.</li>
</ol>
<a id="md:browser-errors" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Browser Errors<a href="#md:browser-errors" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li>Verify that you've set the correct <strong>COOP (Cross-Origin Opener Policy)</strong> and <strong>COEP (Cross-Origin Embedder Policy)</strong> headers as described in the installation instructions.</li>
<li>If using a development server, ensure it's configured to send the required headers.</li>
</ol>
<a id="md:performance-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Performance Issues<a href="#md:performance-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If you're experiencing poor performance:</p>
<ol>
<li>Profile your application using browser developer tools.</li>
<li>Consider using the Worker strategy for computationally intensive tasks.</li>
<li>Optimize your audio processing algorithms.</li>
</ol>
<p>If you're still facing issues after trying these solutions, please open an issue on our GitHub repository with a detailed description of the problem and steps to reproduce it.</p>
</details>
<a id="md:known-issues-and-workarounds" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Known Issues and Workarounds<a href="#md:known-issues-and-workarounds" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><details>
<summary>Click to view known issues and workarounds</summary>
<a id="md:ssr-and-import-errors-with-esm-modules" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SSR and Import Errors with ESM Modules<a href="#md:ssr-and-import-errors-with-esm-modules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When using <code>@ain1084/audio-worklet-stream</code> in a Nuxt 3 project, you may encounter issues during SSR (Server-Side Rendering) or when importing the package as an ESM module. This can result in errors like:</p>
<pre><code class="bash"><span class="hl-1">[nuxt] [request error] [unhandled] [500] Cannot find module </span><span class="hl-2">&#39;/path/to/node_modules/@ain1084/audio-worklet-stream/dist/esm/events&#39;</span><span class="hl-1"> imported from </span><span class="hl-2">&#39;/path/to/node_modules/@ain1084/audio-worklet-stream/dist/esm/index.js&#39;</span>
</code><button type="button">Copy</button></pre>

<a id="md:workarounds" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Workarounds<a href="#md:workarounds" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li>
<p><strong>Disable SSR for the Component</strong></p>
<p>You can disable SSR for the component that uses the package. This can be done by using <code>&lt;client-only&gt;</code>:</p>
<pre><code class="vue"><client-only>
  <MyComponent />
</client-only>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p><strong>Use ssr: false in nuxt.config.ts</strong></p>
<p>You can disable SSR for the entire project in <code>nuxt.config.ts</code>:</p>
<pre><code class="typescript"><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-0">defineNuxtConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">ssr:</span><span class="hl-1"> </span><span class="hl-5">false</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-9">// other configurations</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p><strong>Use import.meta.server and import.meta.client</strong></p>
<p>For a more granular control, you can use <code>import.meta.server</code> and <code>import.meta.client</code> to conditionally import the module only on the client-side. Note that this method is more complex compared to 1 and 2:</p>
<pre><code class="typescript"><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-3">import</span><span class="hl-1">.</span><span class="hl-4">meta</span><span class="hl-1">.</span><span class="hl-4">client</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-7">StreamNodeFactory</span><span class="hl-1"> } = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-5">import</span><span class="hl-1">(</span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-9">// Use StreamNodeFactory</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ol>
<a id="md:example-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Configuration<a href="#md:example-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To ensure proper operation, it is essential to use <code>ssr: false</code> or <code>&lt;client-only&gt;</code> for components and to exclude <code>@ain1084/audio-worklet-stream</code> from Vite's optimization in your <code>nuxt.config.ts</code>:</p>
<pre><code class="typescript"><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-0">defineNuxtConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">ssr:</span><span class="hl-1"> </span><span class="hl-5">false</span><span class="hl-1">, </span><span class="hl-9">// or use &lt;client-only&gt; for specific components</span><br/><span class="hl-1">  </span><span class="hl-4">vite:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">optimizeDeps:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">exclude:</span><span class="hl-1"> [</span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">plugins:</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;configure-response-headers&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">configureServer</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">server</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">server</span><span class="hl-1">.</span><span class="hl-4">middlewares</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">((</span><span class="hl-4">_req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">, </span><span class="hl-4">next</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Embedder-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;require-corp&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">setHeader</span><span class="hl-1">(</span><span class="hl-2">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;same-origin&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-0">next</span><span class="hl-1">()</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">nitro:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">rollupConfig:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">external:</span><span class="hl-1"> </span><span class="hl-2">&#39;@ain1084/audio-worklet-stream&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-9">// Ensure COEP and COOP settings for SharedArrayBuffer</span><br/><span class="hl-1">    </span><span class="hl-4">routeRules:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/**&#39;</span><span class="hl-4">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">headers:</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">&#39;Cross-Origin-Embedder-Policy&#39;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-2">&#39;require-corp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">&#39;Cross-Origin-Opener-Policy&#39;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-2">&#39;same-origin&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">})</span>
</code><button type="button">Copy</button></pre>

</details>
<a id="md:future-plans" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Future Plans<a href="#md:future-plans" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>We are considering potential enhancements for future releases, including:</p>
<ul>
<li>Buffer management optimization: We are considering ways to improve memory efficiency and initialization time, especially when dealing with multiple audio streams.</li>
</ul>
<p>Please note that these are just considerations and may or may not be implemented in future versions. We always aim to balance new features with maintaining the library's stability and simplicity.</p>
<a id="md:notes" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Notes<a href="#md:notes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>
<p><strong>Vite as a Bundler</strong>: This library utilizes Vite to enable the loading and placement of workers without complex configurations. It may not work out-of-the-box with WebPack due to differences in how bundlers handle workers. While similar methods may exist for WebPack, this library currently only supports Vite. Initially, a bundler-independent approach was considered, but a suitable method could not be found.</p>
</li>
<li>
<p><strong>Security Requirements</strong>: Since this library uses <code>SharedArrayBuffer</code>, ensuring browser compatibility requires meeting specific security requirements. For more details, refer to the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements" target="_blank" class="external">MDN Web Docs on SharedArrayBuffer Security Requirements</a>.</p>
</li>
</ul>
<a id="md:contribution" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contribution<a href="#md:contribution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Contributions are welcome! Please open an issue or submit a pull request on GitHub.</p>
<a id="md:license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#md:license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This project is licensed under multiple licenses:</p>
<p><a href="https://opensource.org/licenses/MIT" target="_blank" class="external"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
<a href="https://opensource.org/licenses/Apache-2.0" target="_blank" class="external"><img src="https://img.shields.io/badge/License-Apache_2.0-blue.svg" alt="License"></a></p>
<p>You can choose either license depending on your project needs.</p>
<p>Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in the work by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:audio-worklet-stream-library"><span>Audio <wbr/>Worklet <wbr/>Stream <wbr/>Library</span></a><ul><li><a href="#md:features"><span>Features</span></a></li><li><a href="#md:browser-compatibility"><span>Browser <wbr/>Compatibility</span></a></li><li><a href="#md:prerequisites"><span>Prerequisites</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><ul><li><a href="#md:viteconfigts"><span>vite.config.ts</span></a></li><li><a href="#md:nuxtconfigts"><span>nuxt.config.ts</span></a></li></ul></li><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:overview"><span>Overview</span></a></li><li><a href="#md:buffer-writing-methods"><span>Buffer <wbr/>Writing <wbr/>Methods</span></a></li><li><ul><li><a href="#md:manual"><span>Manual</span></a></li><li><a href="#md:timed"><span>Timed</span></a></li><li><a href="#md:worker"><span>Worker</span></a></li></ul></li></ul></li><li><a href="#md:buffer-underrun-handling"><span>Buffer <wbr/>Underrun <wbr/>Handling</span></a></li><li><a href="#md:details-of-configuration-parameters"><span>Details of <wbr/>Configuration <wbr/>Parameters</span></a></li><li><ul><li><a href="#md:channelcount-all-strategies"><span>channel<wbr/>Count (<wbr/>All strategies)</span></a></li><li><a href="#md:framebuffersize-manual-strategy-only"><span>frame<wbr/>Buffer<wbr/>Size (<wbr/>Manual strategy only)</span></a></li><li><a href="#md:fillinterval-timed-and-worker-strategies-only"><span>fill<wbr/>Interval (<wbr/>Timed and <wbr/>Worker strategies only)</span></a></li><li><a href="#md:framebufferchunks-timed-and-worker-strategies-only"><span>frame<wbr/>Buffer<wbr/>Chunks (<wbr/>Timed and <wbr/>Worker strategies only)</span></a></li></ul></li><li><a href="#md:example"><span>Example</span></a></li><li><a href="#md:performance-optimization-guide"><span>Performance <wbr/>Optimization <wbr/>Guide</span></a></li><li><ul><li><a href="#md:batch-processing"><span>Batch <wbr/>Processing</span></a></li><li><a href="#md:buffer-size-considerations"><span>Buffer <wbr/>Size <wbr/>Considerations</span></a></li><li><a href="#md:worker-based-strategy"><span>Worker-<wbr/>Based <wbr/>Strategy</span></a></li><li><a href="#md:memory-management"><span>Memory <wbr/>Management</span></a></li><li><a href="#md:avoid-frequent-audiocontext-creation"><span>Avoid <wbr/>Frequent <wbr/>Audio<wbr/>Context <wbr/>Creation</span></a></li><li><a href="#md:profiling-and-monitoring"><span>Profiling and <wbr/>Monitoring</span></a></li></ul></li><li><a href="#md:advanced-usage-guide"><span>Advanced <wbr/>Usage <wbr/>Guide</span></a></li><li><ul><li><a href="#md:advanced-worker-usage"><span>Advanced <wbr/>Worker <wbr/>Usage</span></a></li><li><a href="#md:handling-multiple-audio-streams"><span>Handling <wbr/>Multiple <wbr/>Audio <wbr/>Streams</span></a></li><li><a href="#md:integrating-with-other-web-audio-api-features"><span>Integrating with <wbr/>Other <wbr/>Web <wbr/>Audio API <wbr/>Features</span></a></li><li><a href="#md:error-handling-and-debugging"><span>Error <wbr/>Handling and <wbr/>Debugging</span></a></li></ul></li><li><a href="#md:troubleshooting-guide"><span>Troubleshooting <wbr/>Guide</span></a></li><li><ul><li><a href="#md:audio-playback-issues"><span>Audio <wbr/>Playback <wbr/>Issues</span></a></li><li><ul><li><a href="#md:no-sound"><span>No <wbr/>Sound</span></a></li><li><a href="#md:choppy-or-glitchy-playback"><span>Choppy or <wbr/>Glitchy <wbr/>Playback</span></a></li></ul></li><li><a href="#md:buffer-underruns"><span>Buffer <wbr/>Underruns</span></a></li><li><a href="#md:worker-related-issues"><span>Worker-<wbr/>Related <wbr/>Issues</span></a></li><li><ul><li><a href="#md:worker-not-starting"><span>Worker <wbr/>Not <wbr/>Starting</span></a></li><li><a href="#md:data-not-being-processed-in-worker"><span>Data <wbr/>Not <wbr/>Being <wbr/>Processed in <wbr/>Worker</span></a></li></ul></li><li><a href="#md:browser-compatibility-issues"><span>Browser <wbr/>Compatibility <wbr/>Issues</span></a></li><li><ul><li><a href="#md:feature-not-working-in-specific-browsers"><span>Feature <wbr/>Not <wbr/>Working in <wbr/>Specific <wbr/>Browsers</span></a></li></ul></li><li><a href="#md:build-and-integration-issues"><span>Build and <wbr/>Integration <wbr/>Issues</span></a></li><li><ul><li><a href="#md:module-not-found-errors"><span>Module <wbr/>Not <wbr/>Found <wbr/>Errors</span></a></li><li><a href="#md:browser-errors"><span>Browser <wbr/>Errors</span></a></li></ul></li><li><a href="#md:performance-issues"><span>Performance <wbr/>Issues</span></a></li></ul></li><li><a href="#md:known-issues-and-workarounds"><span>Known <wbr/>Issues and <wbr/>Workarounds</span></a></li><li><ul><li><a href="#md:ssr-and-import-errors-with-esm-modules"><span>SSR and <wbr/>Import <wbr/>Errors with ESM <wbr/>Modules</span></a></li><li><a href="#md:workarounds"><span>Workarounds</span></a></li><li><a href="#md:example-configuration"><span>Example <wbr/>Configuration</span></a></li></ul></li><li><a href="#md:future-plans"><span>Future <wbr/>Plans</span></a></li><li><a href="#md:notes"><span>Notes</span></a></li><li><a href="#md:contribution"><span>Contribution</span></a></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@ain1084/audio-worklet-stream - v1.0.1</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer></footer><div class="overlay"></div></body></html>
